#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main() {
    
    srand(time(NULL));

    
    int base_seq[5] = { 1, 4, 3, 5, 2 };

    // 1부터 5까지 숫자를 무작위로 섞는다 
    int map[6];
    for (int i = 1; i <= 5; i++) {
        map[i] = i;
    }
    for (int i = 5; i >= 2; i--) {
        // 1부터 i 사이에서 아무 숫자 하나를 고른다.
        int j = rand() % i + 1;
        // 현재 숫자와 무작위로 고른 숫자의 자리를 바꾼다.
        int tmp = map[i];
        map[i] = map[j];
        map[j] = tmp;
    }

    // 원래 정답 순서대로 숫자를 바꿔서 최종 정답을 만든다.
    int answer[5];
    for (int i = 0; i < 5; i++) {
        answer[i] = map[base_seq[i]];
    }

    // 힌트가 나오는 순서도 무작위로 섞기 위한 목록을 만든다.
    int order[5] = { 0, 1, 2, 3, 4 };
    for (int i = 4; i > 0; i--) {
        // 힌트 순서를 무작위로 섞는다.
        int j = rand() % (i + 1);
        int tmp = order[i];
        order[i] = order[j];
        order[j] = tmp;
    }

    printf("--- 숫자 순열 맞추기 퍼즐 ---\n");

    // 무작위로 섞인 순서에 따라 힌트를 하나씩 보여준다.
    for (int k = 0; k < 5; k++) {
        printf("%d. ", k + 1);
        switch (order[k]) {
        case 0:
            // 힌트 0: 이 숫자는 첫 번째 자리에 고정된다.
            printf("숫자 %d은 1번째 자리에 위치해야 한다.\n", map[1]);
            break;
        case 1:
            // 힌트 1: 이 두 숫자는 바로 옆에 붙어 있어야 한다.
            printf("숫자 %d는 숫자 %d 바로 앞에 위치해야 한다.\n", map[4], map[3]);
            break;
        case 2:
            // 힌트 2: 이 숫자는 다른 숫자보다 앞에 나와야 한다.
            printf("숫자 %d은 숫자 %d보다 먼저 나타나야 한다.\n", map[3], map[5]);
            break;
        case 3:
            // 힌트 3: 이 두 숫자는 바로 옆에 붙어 있어야 한다.
            printf("숫자 %d는 숫자 %d 바로 앞에 위치해야 한다.\n", map[5], map[2]);
            break;
        case 4:
            // 힌트 4: 이 숫자는 다른 숫자보다 앞에 나와야 한다.
            printf("숫자 %d은 숫자 %d보다 먼저 나타나야 한다.\n", map[1], map[5]);
            break;
        }
    }

    // 정답을 입력받고 확인하는 부분 시작
    printf("\n정답을 입력하세요 (예: 4 2 3 1 5): ");
    int input[5];
    while (1) {
        // 5개의 숫자를 입력받는다.
        if (scanf_s("%d %d %d %d %d",
            &input[0], &input[1], &input[2], &input[3], &input[4]) != 5) {
            printf("입력 형식이 올바르지 않습니다. 숫자 5개를 공백으로 구분하여 다시 입력하세요: ");
            // 잘못된 글자를 없앤다.
            int c;
            while ((c = getchar()) != '\n' && c != EOF);
            continue;
        }
        // 입력한 값과 진짜 정답을 하나하나 비교한다.
        int correct = 1;
        for (int i = 0; i < 5; i++) {
            if (input[i] != answer[i]) {
                // 하나라도 다르면 틀린 것이다.
                correct = 0;
                break;
            }
        }
        if (correct) {
            printf("정답입니다!\n");
            break;
        }
        else {
            printf("틀렸습니다. 다시 시도하세요: ");
        }
    }
    return 0;
}
